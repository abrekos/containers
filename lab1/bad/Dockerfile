# 1. Первая плохая практика
# Использование тега latest может поломать приложение,
# если вдруг выйдет обратно несовместимая версия базового образа
FROM node:latest

RUN mkdir -p /var/www/app
WORKDIR /var/www/app

# 2. Вторая плохая практика
# Сначала копируем все
COPY ./project/server /var/www/app

# И только потом устанавливаем зависимости
# Таким образом, при изменении любого файла, при сборке не будет использоваться кеш
RUN npm install

# Не совсем плохая практика, просто бессмысленная вещь:
# в COPY указан полный путь /var/www/app, хотя это не имеет смысла, так как указан WORKDIR
# и вместо полного пути можно указывать относительный: ./


# 3. Третья плохая практика
# Она заключается в отсутствующей строке =)
# Здесь не используются томы, что приведет к тому, что все данные
# приложения будут храниться внутри контейнера, и не будут сохраняться при
# перезапуске контейнера

EXPOSE 3000

ENTRYPOINT npm start